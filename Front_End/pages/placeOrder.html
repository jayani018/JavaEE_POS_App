<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../assets/css/bootstrap.css">
</head>
<style>
    body {
        background-color: #f2f2f2;
        /* Replace with your desired background color */
        /*overflow: hidden;*/
    }

    .navbar {
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 10000000000;
    }

    .card {
        margin: 20px;
    }

    .del:hover {
        color: red;
    }

    section {
        height: auto;
    }
</style>
<body>
<section id="navSection">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand homeNav" href=""><i class="fas fa-cash-register"></i> POS System</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link homeNav" id=""><i class="fas fa-home"></i> Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="customerNav" href="pages/customer.html"><i class="fas fa-users"></i>
                        Customer</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="itemNav" href="pages/item.html"><i class="fas fa-boxes"></i> Items</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="placeorderNav" href="pages/placeOrder.html"><i
                            class="fas fa-shopping-cart"></i> Place
                        Order</a>
                </li>
            </ul>
        </div>
    </nav>

</section>
<section id="placeorderSection" style="margin-top: 80px;">

    <div class="container">
        <h2><i class="bi bi-bag-check"></i> Place Order</h2>
        <div class="row mt-4">
            <div class="col-sm-4">
                <form>
                    <h4><i class="bi bi-file-earmark-text"></i> Invoice</h4>
                    <div class="form-group">
                        <label for="orderId"><i class="bi bi-hash"></i> Order ID</label>
                        <input type="text" class="form-control" id="orderId">
                    </div>
                    <div class="form-group">
                        <label for="orderDate"><i class="bi bi-calendar"></i> Order Date</label>
                        <input type="date" class="form-control" id="orderDate">
                    </div>
                    <div class="form-group">
                        <label for="customerId1"><i class="bi bi-person-badge"></i> Customer ID</label>
                        <input type="text" class="form-control" id="customerId1">
                    </div>
                    <div class="form-group">
                        <label for="customerName"><i class="bi bi-person"></i> Customer Name</label>
                        <input type="text" class="form-control" id="customerName">
                    </div>
                    <div class="form-group">
                        <label for="customerAddress"><i class="bi bi-house-door"></i> Customer Address</label>
                        <input type="text" class="form-control" id="customerAddress">
                    </div>
                    <div class="form-group">
                        <label for="customerSalary"><i class="bi bi-cash"></i> Customer Salary</label>
                        <input type="text" class="form-control" id="customerSalary">
                    </div>
                </form>
            </div>
            <div class="col-sm-4">
                <form>
                    <h4><i class="bi bi-cart-plus"></i> Items</h4>
                    <div class="form-group">
                        <label for="itemCode"><i class="bi bi-tag"></i> Item Code</label>
                        <input type="text" class="form-control" id="itemCode">
                    </div>
                    <div class="form-group">
                        <label for="itemName"><i class="bi bi-card-list"></i> Item Name</label>
                        <input type="text" class="form-control" id="itemName">
                    </div>
                    <div class="form-group">
                        <label for="unitPrice"><i class="bi bi-currency-dollar"></i> Unit Price</label>
                        <input type="text" class="form-control" id="unitPrice">
                    </div>
                    <div class="form-group">
                        <label for="qtyOnHand"><i class="bi bi-archive"></i> Qty On Hand</label>
                        <input type="text" class="form-control" id="qtyOnHand">
                    </div>
                    <button type="button" class="btn btn-primary" id="addToCart"><i class="bi bi-cart-plus"></i> Add to
                        Cart
                    </button>
                    <button type="button" class="btn btn-secondary"><i class="bi bi-x-circle"></i> Clear</button>
                </form>
            </div>
            <div class="col-sm-4">
                <form>
                    <h4><i class="bi bi-currency-dollar"></i> Payment Details</h4>
                    <div class="form-group">
                        <label for="numItems"><i class="bi bi-list-ol"></i> Number of Items</label>
                        <input type="text" class="form-control" id="numItems">
                    </div>
                    <div class="form-group">
                        <label for="total"><i class="bi bi-cash-stack"></i> Total</label>
                        <input type="text" class="form-control" id="total">
                    </div>
                    <div class="form-group">
                        <label for="cash"><i class="bi bi-cash"></i> Cash</label>
                        <input type="text" class="form-control" id="cash">
                    </div>
                    <div class="form-group">
                        <label for="balance"><i class="bi bi-currency-dollar"></i> Balance</label>
                        <input type="text" class="form-control" id="balance">
                    </div>
                    <button type="button" class="btn btn-success"><i class="bi bi-check-circle"></i> Place
                        Order
                    </button>
                    <button type="button" class="btn btn-danger"><i class="bi bi-x-circle"></i> Cancel</button>
                </form>
            </div>
        </div>
    </div>
    <div class="container mt-4">
        <div class="row">
            <div class="col-sm-12">
                <h4><i class="bi bi-cart3 mb-4"></i> Cart Details</h4>
                <table class="table mt-3" id="table">
                    <thead>
                    <tr>
                        <th><i class="bi bi-tag"></i> Item Code</th>
                        <th><i class="bi bi-card-text"></i> Name</th>
                        <th><i class="bi bi-cash"></i> Unit Price</th>
                        <th><i class="bi bi-list-ol"></i> Qty on Hand</th>
                        <th><i class="bi bi-cash"></i> Total</th>
                        <th><i class="bi bi-trash"></i> Delete</th>
                    </tr>
                    </thead>
                    <tbody id="addToCartTBody">
                    <tr>
                        <td>001</td>
                        <td>Item 1</td>
                        <td>$10</td>
                        <td>5</td>
                        <td>$50</td>
                        <td><i class="bi bi-trash del"></i></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</section>
<script src="../assets/js/jquery-3.6.1.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script>

    const BASE_URL = "http://localhost:8084/Back_End_war_exploded/pages/";
    $("#customerId1").keyup(function (event) {
        // Check if the Enter key (key code 13) is pressed
        if (event.keyCode === 13) {
            // Call the function to handle the Enter key press
            let id = $("#customerId1").val();
            $.ajax({
                url: BASE_URL + "customer?cusId=" + id,
                success: function (response) {
                    let customers = response.data[0];
                    console.log(customers)
                    // console.log(response.data[0])
                    // for (let customer of customers){
                    //   console.table(customers)
                    $("#customerName").val(customers.cusName);
                    $("#customerAddress").val(customers.cusAddress);
                    $("#customerSalary").val(customers.cusSalary);
                    //   console.log(customers.cusName)
                    // }

                },
                dataType: "json",
                error: function (error) {
                    alert(error.responseJSON.message);
                }
            });
        }
    });
    $("#cash").keyup(function (event) {
        // Check if the Enter key (key code 13) is pressed
        if (event.keyCode === 13) {
          $("#balance").val(   $("#cash").val()-$("#total").val());
        }
    })

    $("#itemCode").keyup(function (event) {
        // Check if the Enter key (key code 13) is pressed
        if (event.keyCode === 13) {
            // Call the function to handle the Enter key press
            let code = $("#itemCode").val();
            $.ajax({
                url: BASE_URL + "item?itemCode=" + code,
                success: function (response) {
                    let item = response.data[0];
                    $("#itemName").val(item.name);
                    $("#unitPrice").val(item.unitPrice);
                    $("#qtyOnHand").val(item.qtyOnHand);
                },
                dataType: "json",
                error: function (error) {
                    alert(error.responseJSON.message);
                }
            });
        }
    });
    $("#addToCartTBody").empty();
    $("#addToCart").click(function () {
        let itemCode = $("#itemCode").val();
        let itemName = $("#itemName").val();
        let unitPrice = $("#unitPrice").val();
        let qtyOnHand = $("#qtyOnHand").val();
        let total = unitPrice * qtyOnHand;

        let row = `<tr><td>${itemCode}</td><td>${itemName}</td><td>${unitPrice}</td><td>${qtyOnHand}</td><td>${total} $</td></tr>`;
        $("#addToCartTBody").append(row);

        var totalSum = 0;
        var qtyOnHandCount = 0;
        var tbody = $("#addToCartTBody");
        tbody.find("tr").each(function () {
            var totalText = $(this).find("td:eq(4)").text();
            var totalValue = parseFloat(totalText.replace("$", ""));
            var qtyOnHandText = $(this).find("td:eq(3)").text();
            var qtyOnHandValue = parseInt(qtyOnHandText);
            if (!isNaN(totalValue)) {
                totalSum += totalValue;

            }
            if (!isNaN(qtyOnHandValue)) {
                qtyOnHandCount += qtyOnHandValue;
            }

        });
        $("#total").val(totalSum);
        var rowCount = tbody.find("tr").length;
        console.log(rowCount)
        $("#numItems").val(qtyOnHandCount);
    })


</script>
</body>
</html>